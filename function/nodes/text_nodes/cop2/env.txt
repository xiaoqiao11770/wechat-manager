#type: node
#context: cop2
#internal: env
#icon: COP2/env

= Environment =

"""Applies an environment map to an image."""

Environment applies an environment map to an image which contains either
a normal or bump map. Both cubic and spherical maps are supported.

The environment map can be rotated around the scene, and it can be
blended with the input image.

See [how to create an environment/reflection map|/render/envmaps].

TIP:
    To only show the environment map on 'shiny' parts of the image, mask
    out the shiny parts and connect the matte to the Mask input.

TIP:
    To make the environment map blurrier, use a blur or defocus COP on
    the environment map.

NOTE:
    Normal maps generally produce better results than bump maps.

[Include:copvexnode]

[Include:coppixelparms#coppixeldescription/]

[Include:copmaskparms#copmaskdescription/]

@parameters

    == Environment ==

        Map Rotation:
            #channels: /rotate1 /rotate2 /rotate3

            Rotates the map about the scene.
        Environment Map:
            #channels: /maptype

            Selects the type of map connected to input 2.


            Spherical:
                The map is a spherical project onto a rectangular image
                (much like a world map).
            Cube (Cross):
                The map looks like a sideways cross: Left Front Right
                Back, with Top above Front and Bottom below.
            Cube (Strip):
                The map is a horizontal strip of images, each in various
                orientations. The order of images is Right, Left, Back,
                Front, Bottom, Top.
        Cube Face X Size:
            #channels: /cubex

            For cubic maps, this is the width of one face.
        Cube Face Y Size:
            #channels: /cubey

            For cubic maps, this is the height of one face (normally
            the same as the width).
        Reflect Amount:
            #channels: /reflect

            The amount of the environment map to blend in.
        Ambient Amount:
            #channels: /ambient

            The level of the input image, from 0 (black) to 1 (same
            image).
        Direction Source:
            #channels: /source

            Environment mapping can be done from either a normal map
            (usually generated by a Renderer) or a bump map (can be
            generated with the Bump COP). Normal maps generally produce
            better results.


            Normal Map:
                Use a normal map ('N').
            Bump Map:
                Use a bump map ('B').
    [Include:copmaskparms#copmaskparms/]

    [Include:coppixelparms#coppixelparms/]

@locals
    L:
    S:
    E:
    IL:
    SR:
    NP:
    W:
    H:
    I:
    IT:
    AI:
    PI:
    PC:
    CXRES:
    CYRES:
    CPIXA:
    CBP:
    CWP:
    CDEPTH:

@related
    - [Node:cop2/bump]
    - [Node:cop2/light]

